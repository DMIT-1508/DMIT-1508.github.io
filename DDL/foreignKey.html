<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Foreign Key Constraint | DMIT-1508 Student Notes</title>
    <meta name="description" content="Database Fundamentals">
    
    
    <link rel="preload" href="/assets/css/0.styles.a96377cd.css" as="style"><link rel="preload" href="/assets/js/app.b4dd69f7.js" as="script"><link rel="preload" href="/assets/js/1.dc025775.js" as="script"><link rel="preload" href="/assets/js/63.f0174429.js" as="script"><link rel="preload" href="/assets/js/2.fa38e49b.js" as="script"><link rel="prefetch" href="/assets/js/3.249150de.js"><link rel="prefetch" href="/assets/js/4.34f9d3ab.js"><link rel="prefetch" href="/assets/js/5.24cf48d9.js"><link rel="prefetch" href="/assets/js/6.7ecb3584.js"><link rel="prefetch" href="/assets/js/7.c7eeb577.js"><link rel="prefetch" href="/assets/js/8.168aff09.js"><link rel="prefetch" href="/assets/js/9.8e625da5.js"><link rel="prefetch" href="/assets/js/10.2dce0e33.js"><link rel="prefetch" href="/assets/js/11.a0012d97.js"><link rel="prefetch" href="/assets/js/12.41b39cb6.js"><link rel="prefetch" href="/assets/js/13.5185e165.js"><link rel="prefetch" href="/assets/js/14.ab0f0b46.js"><link rel="prefetch" href="/assets/js/15.9eb5de3f.js"><link rel="prefetch" href="/assets/js/16.660457ff.js"><link rel="prefetch" href="/assets/js/17.0c01a66e.js"><link rel="prefetch" href="/assets/js/18.35c87bec.js"><link rel="prefetch" href="/assets/js/19.12e58cfb.js"><link rel="prefetch" href="/assets/js/20.04c15f4c.js"><link rel="prefetch" href="/assets/js/21.a28c2be3.js"><link rel="prefetch" href="/assets/js/22.2870532b.js"><link rel="prefetch" href="/assets/js/23.2668a31a.js"><link rel="prefetch" href="/assets/js/24.28396661.js"><link rel="prefetch" href="/assets/js/25.e947cf99.js"><link rel="prefetch" href="/assets/js/26.d920387a.js"><link rel="prefetch" href="/assets/js/27.dec3b092.js"><link rel="prefetch" href="/assets/js/28.d4e58c7b.js"><link rel="prefetch" href="/assets/js/29.b3725770.js"><link rel="prefetch" href="/assets/js/30.277018e7.js"><link rel="prefetch" href="/assets/js/31.1c36d19d.js"><link rel="prefetch" href="/assets/js/32.85541070.js"><link rel="prefetch" href="/assets/js/33.3016cfe0.js"><link rel="prefetch" href="/assets/js/34.7ecab17c.js"><link rel="prefetch" href="/assets/js/35.779af5a1.js"><link rel="prefetch" href="/assets/js/36.5eca2943.js"><link rel="prefetch" href="/assets/js/37.1cf5878b.js"><link rel="prefetch" href="/assets/js/38.d3875e44.js"><link rel="prefetch" href="/assets/js/39.b55d93c4.js"><link rel="prefetch" href="/assets/js/40.ad270bd5.js"><link rel="prefetch" href="/assets/js/41.c00e986e.js"><link rel="prefetch" href="/assets/js/42.0720098d.js"><link rel="prefetch" href="/assets/js/43.00d3ee07.js"><link rel="prefetch" href="/assets/js/44.a305fd8d.js"><link rel="prefetch" href="/assets/js/45.ca79e2f5.js"><link rel="prefetch" href="/assets/js/46.14ed7f2c.js"><link rel="prefetch" href="/assets/js/47.e0c73412.js"><link rel="prefetch" href="/assets/js/48.14684aeb.js"><link rel="prefetch" href="/assets/js/49.156077e6.js"><link rel="prefetch" href="/assets/js/50.20fd346e.js"><link rel="prefetch" href="/assets/js/51.d415e61d.js"><link rel="prefetch" href="/assets/js/52.d7c65ca9.js"><link rel="prefetch" href="/assets/js/53.b237f819.js"><link rel="prefetch" href="/assets/js/54.a8b408fa.js"><link rel="prefetch" href="/assets/js/55.9078508e.js"><link rel="prefetch" href="/assets/js/56.625cfb71.js"><link rel="prefetch" href="/assets/js/57.f1c4e72e.js"><link rel="prefetch" href="/assets/js/58.a086e63e.js"><link rel="prefetch" href="/assets/js/59.062d5b15.js"><link rel="prefetch" href="/assets/js/60.67858fe7.js"><link rel="prefetch" href="/assets/js/61.b9e501be.js"><link rel="prefetch" href="/assets/js/62.281d4369.js"><link rel="prefetch" href="/assets/js/64.070a85b0.js"><link rel="prefetch" href="/assets/js/65.48be2272.js"><link rel="prefetch" href="/assets/js/66.890930c5.js"><link rel="prefetch" href="/assets/js/67.b45468e6.js"><link rel="prefetch" href="/assets/js/68.fd3a98c3.js"><link rel="prefetch" href="/assets/js/69.2983863a.js"><link rel="prefetch" href="/assets/js/70.e5011d38.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a96377cd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DMIT-1508 Student Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/about/" class="nav-link">Home</a></div><div class="nav-item"><a href="/Design/" class="nav-link">Normalization</a></div><div class="nav-item"><a href="/DDL/" class="nav-link router-link-active">DDL</a></div><div class="nav-item"><a href="/DML/" class="nav-link">DML</a></div><div class="nav-item"><a href="/SQL/" class="nav-link">SQL</a></div><div class="nav-item"><a href="/DCL/" class="nav-link">DCL</a></div><div class="nav-item"><a href="https://dmit-1508.github.io/about/slides-installing-sql-server.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MS SQL 2017
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/DMIT-1508/DMIT-1508.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/about/" class="nav-link">Home</a></div><div class="nav-item"><a href="/Design/" class="nav-link">Normalization</a></div><div class="nav-item"><a href="/DDL/" class="nav-link router-link-active">DDL</a></div><div class="nav-item"><a href="/DML/" class="nav-link">DML</a></div><div class="nav-item"><a href="/SQL/" class="nav-link">SQL</a></div><div class="nav-item"><a href="/DCL/" class="nav-link">DCL</a></div><div class="nav-item"><a href="https://dmit-1508.github.io/about/slides-installing-sql-server.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MS SQL 2017
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/DMIT-1508/DMIT-1508.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/DDL/" class="sidebar-link">Data Definition Language - DDL in SQL</a></li><li><a href="/DDL/createTable.html" class="sidebar-link">Basic Table Definition</a></li><li><a href="/DDL/primaryKey.html" class="sidebar-link">Primary Key Constraint</a></li><li><a href="/DDL/foreignKey.html" class="active sidebar-link">Foreign Key Constraint</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DDL/foreignKey.html#foreign-key-exercise" class="sidebar-link">Foreign Key Exercise</a></li></ul></li><li><a href="/DDL/defaultConstraint.html" class="sidebar-link">Default Constraint</a></li><li><a href="/DDL/checkConstraint.html" class="sidebar-link">The Check Constraint</a></li><li><a href="/DDL/uniqueConstraint.html" class="sidebar-link">Unique Constraint</a></li><li><a href="/DDL/alterTable.html" class="sidebar-link">Alter Table</a></li><li><a href="/DDL/createView.html" class="sidebar-link">Create View</a></li><li><a href="/demos/esp/ddl/" class="sidebar-link">ESP - DDL Demo</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="foreign-key-constraint"><a href="#foreign-key-constraint" aria-hidden="true" class="header-anchor">#</a> Foreign Key Constraint</h1> <p>The foreign key constraint defines a relationship between rows (usually in different tables). In addition, the foreign key constraint defines a parent-child relationship between the tables involved. The table with the foreign key acts as the child table in the relationship. The table with the associated primary key acts as the parent table in the relationship. Consider the following tables for a chain of stores that operates internationally.</p> <p>ERD</p> <p>CountryId and StoreId are unique. RegionId is unique within Country (the first region in any country is region 1).</p> <p>In the RegionInCountry table (child) the foreign key, CountryId, relates rows to the parent table, Country. A column level foreign key constraint, for the CountryId column in the RegionInCountry table, implements this relationship.</p> <p>In the StoreInRegion table (child) the foreign key, CountryId and RegionId, relates rows to the parent table, RegionInCountry. A table level foreign key constraint, CountryId and RegionId columns, in the StoreInRegion table, implements this relationship.</p> <p>The foreign key constraint defines referential integrity between two tables. Operations that affect the tables and or the data stored within the tables must comply with referential integrity. This affects:</p> <ul><li>Dropping tables.</li> <li>Creating tables.</li> <li>Inserting/Updating/Deleting rows in tables.</li></ul> <p>The bottom line for referential integrity is that a child row/table cannot exist without its associated parent row/table. Therefore:</p> <ul><li>You must Drop a child table BEFORE you Drop the associated parent table.</li> <li>You must Create a parent table BEFORE you Create the associated child table.</li> <li>The value of a column acting as a foreign key must be:
<ul><li>A value that exists as a primary key in the associated parent table, or</li> <li>NULL</li></ul></li></ul> <p>If we were to create a script file to drop the existing definition of the Store tables and recreate them we would sequence the commands in the following order:</p> <div class="language- extra-class"><pre class="language-text"><code>Drop Table StoreInRegion
	Drop Table RegionInCountry
	Drop Table Country
	Create Table Country ( . . . 
	Create Table RegionInCountry( . . . 
	Create Table StoreInRegion( . . .
</code></pre></div><p>A column acting as a foreign key can be defined as a NULL or as a NOT NULL column and must have the same datatype as its associated primary key. The DBMS will NOT automatically create an index for a foreign key.</p> <p>Foreign Key Constraint Syntax</p> <div class="language- extra-class"><pre class="language-text"><code>[CONSTRAINT constraint name ]
    [ FOREIGN KEY ( col_name [, . . . col_name16 ] ]
    REFERENCES table_name ( ref_col [, . . . ref_col16] )
</code></pre></div><p>col_name</p> <p>identifies the column(s) acting as the foreign key</p> <p>table_name</p> <p>identifies the parent table</p> <p>ref_col</p> <p>identifies the primary key in the associated parent table</p> <p>This demonstrates the use of a column level foreign key constraint. Note that by itself, the CountryId is acting as a foreign key while at the same time it is part of a concatenated primary key.</p> <p>Foreign Key Example (column level constraint)</p> <p>To define the foreign key constraint for the RegionInCountry table:</p> <div class="language- extra-class"><pre class="language-text"><code>CREATE TABLE RegionInCountry
(
    CountryId	smallint		not null
        Constraint FK_RegionInCountryToCountry
            references Country (CountryId),
    RegionId	smallint		not null,
    Name		varchar(100) 	not null,
    Constraint	PK_CountryId_RegionId 
    Primary key clustered (CountryId, RegionId)
)
</code></pre></div><p>This demonstrates the use of a table level foreign key constraint. The foreign key constraint applies to two columns, hence the use of the table level constraint.</p> <p>Foreign Key Example (table level constraint)</p> <p>To define the foreign key constraint for the Store In Region table:</p> <div class="language- extra-class"><pre class="language-text"><code>CREATE TABLE StoreInRegion
(
    CountryId	smallint		not null,
    RegionId	smallint		not null,
    StoreId	smallint		not null,
    Phone	varchar(100) 	not null,
    Constraint	PK_CountryId_RegionId_StoreId 
        Primary key clustered (CountryId, RegionId, StoreId),
    Constraint	 FK_StoreInRegionToRegionInCountry 
        Foreign Key (CountryId, RegionId)
            References RegionInCountry (CountryId, RegionId)
)
</code></pre></div><h2 id="foreign-key-exercise"><a href="#foreign-key-exercise" aria-hidden="true" class="header-anchor">#</a> Foreign Key Exercise</h2> <p>Modify the script that defines the Employee, Project and EmployeeOnProject tables to include the necessary foreign key constraint definitions.</p> <p>Create the Department table as a stand-alone table for now (no relationships to other tables). Use the identity property for the Department Number.</p> <p>ERD</p> <p>Use Sp_Help to confirm that the tables were created successfully. The constraint information is displayed in the 7th grid (when viewing sp_help output via display in grid).</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">9/21/2018, 3:07:16 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/DDL/primaryKey.html" class="prev">
          Primary Key Constraint
        </a></span> <span class="next"><a href="/DDL/defaultConstraint.html">
          Default Constraint
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/1.dc025775.js" defer></script><script src="/assets/js/63.f0174429.js" defer></script><script src="/assets/js/2.fa38e49b.js" defer></script><script src="/assets/js/app.b4dd69f7.js" defer></script>
  </body>
</html>

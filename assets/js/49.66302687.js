(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{236:function(e,t,n){"use strict";n.r(t);var a=n(0),i=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"foreign-key-constraint"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#foreign-key-constraint","aria-hidden":"true"}},[e._v("#")]),e._v(" Foreign Key Constraint")]),e._v(" "),n("p",[e._v("The foreign key constraint defines a relationship between rows (usually in different tables). In addition, the foreign key constraint defines a parent-child relationship between the tables involved. The table with the foreign key acts as the child table in the relationship. The table with the associated primary key acts as the parent table in the relationship. Consider the following tables for a chain of stores that operates internationally.")]),e._v(" "),n("p",[e._v("ERD")]),e._v(" "),n("p",[e._v("CountryId and StoreId are unique. RegionId is unique within Country (the first region in any country is region 1).")]),e._v(" "),n("p",[e._v("In the RegionInCountry table (child) the foreign key, CountryId, relates rows to the parent table, Country. A column level foreign key constraint, for the CountryId column in the RegionInCountry table, implements this relationship.")]),e._v(" "),n("p",[e._v("In the StoreInRegion table (child) the foreign key, CountryId and RegionId, relates rows to the parent table, RegionInCountry. A table level foreign key constraint, CountryId and RegionId columns, in the StoreInRegion table, implements this relationship.")]),e._v(" "),n("p",[e._v("The foreign key constraint defines referential integrity between two tables. Operations that affect the tables and or the data stored within the tables must comply with referential integrity. This affects:")]),e._v(" "),n("ul",[n("li",[e._v("Dropping tables.")]),e._v(" "),n("li",[e._v("Creating tables.")]),e._v(" "),n("li",[e._v("Inserting/Updating/Deleting rows in tables.")])]),e._v(" "),n("p",[e._v("The bottom line for referential integrity is that a child row/table cannot exist without its associated parent row/table. Therefore:")]),e._v(" "),n("ul",[n("li",[e._v("You must Drop a child table BEFORE you Drop the associated parent table.")]),e._v(" "),n("li",[e._v("You must Create a parent table BEFORE you Create the associated child table.")]),e._v(" "),n("li",[e._v("The value of a column acting as a foreign key must be:\n"),n("ul",[n("li",[e._v("A value that exists as a primary key in the associated parent table, or")]),e._v(" "),n("li",[e._v("NULL")])])])]),e._v(" "),n("p",[e._v("If we were to create a script file to drop the existing definition of the Store tables and recreate them we would sequence the commands in the following order:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("Drop Table StoreInRegion\n\tDrop Table RegionInCountry\n\tDrop Table Country\n\tCreate Table Country ( . . . \n\tCreate Table RegionInCountry( . . . \n\tCreate Table StoreInRegion( . . .\n")])])]),n("p",[e._v("A column acting as a foreign key can be defined as a NULL or as a NOT NULL column and must have the same datatype as its associated primary key. The DBMS will NOT automatically create an index for a foreign key.")]),e._v(" "),n("p",[e._v("Foreign Key Constraint Syntax")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("[CONSTRAINT constraint name ]\n    [ FOREIGN KEY ( col_name [, . . . col_name16 ] ]\n    REFERENCES table_name ( ref_col [, . . . ref_col16] )\n")])])]),n("p",[e._v("col_name")]),e._v(" "),n("p",[e._v("identifies the column(s) acting as the foreign key")]),e._v(" "),n("p",[e._v("table_name")]),e._v(" "),n("p",[e._v("identifies the parent table")]),e._v(" "),n("p",[e._v("ref_col")]),e._v(" "),n("p",[e._v("identifies the primary key in the associated parent table")]),e._v(" "),n("p",[e._v("This demonstrates the use of a column level foreign key constraint. Note that by itself, the CountryId is acting as a foreign key while at the same time it is part of a concatenated primary key.")]),e._v(" "),n("p",[e._v("Foreign Key Example (column level constraint)")]),e._v(" "),n("p",[e._v("To define the foreign key constraint for the RegionInCountry table:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("CREATE TABLE RegionInCountry\n(\n    CountryId\tsmallint\t\tnot null\n        Constraint FK_RegionInCountryToCountry\n            references Country (CountryId),\n    RegionId\tsmallint\t\tnot null,\n    Name\t\tvarchar(100) \tnot null,\n    Constraint\tPK_CountryId_RegionId \n    Primary key clustered (CountryId, RegionId)\n)\n")])])]),n("p",[e._v("This demonstrates the use of a table level foreign key constraint. The foreign key constraint applies to two columns, hence the use of the table level constraint.")]),e._v(" "),n("p",[e._v("Foreign Key Example (table level constraint)")]),e._v(" "),n("p",[e._v("To define the foreign key constraint for the Store In Region table:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("CREATE TABLE StoreInRegion\n(\n    CountryId\tsmallint\t\tnot null,\n    RegionId\tsmallint\t\tnot null,\n    StoreId\tsmallint\t\tnot null,\n    Phone\tvarchar(100) \tnot null,\n    Constraint\tPK_CountryId_RegionId_StoreId \n        Primary key clustered (CountryId, RegionId, StoreId),\n    Constraint\t FK_StoreInRegionToRegionInCountry \n        Foreign Key (CountryId, RegionId)\n            References RegionInCountry (CountryId, RegionId)\n)\n")])])]),n("h2",{attrs:{id:"foreign-key-exercise"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#foreign-key-exercise","aria-hidden":"true"}},[e._v("#")]),e._v(" Foreign Key Exercise")]),e._v(" "),n("p",[e._v("Modify the script that defines the Employee, Project and EmployeeOnProject tables to include the necessary foreign key constraint definitions.")]),e._v(" "),n("p",[e._v("Create the Department table as a stand-alone table for now (no relationships to other tables). Use the identity property for the Department Number.")]),e._v(" "),n("p",[e._v("ERD")]),e._v(" "),n("p",[e._v("Use Sp_Help to confirm that the tables were created successfully. The constraint information is displayed in the 7th grid (when viewing sp_help output via display in grid).")])])}],!1,null,null,null);t.default=i.exports}}]);